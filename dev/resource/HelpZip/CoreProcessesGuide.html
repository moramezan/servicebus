<!DOCTYPE html>
<html>
<head>
    <title></title>
    <style type="text/css">
        body {background: url('./inPageClouds.png') top left no-repeat;}

        code {font-family: "Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace; font-size:95%;}
        .contact {font-family: "Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace;
            font-size:102%;
            text-align:center}
        .contact.dot {font-weight:bold;}
        a {text-decoration:none;}
        .gist-file{
            margin-top: 10px;
            margin-right: 20px;
        }

        .extra-details{
            margin-left: 5%;
        }

    </style>
</head>
    <body>
        <table>
            <tr>
                <td>
                    <h2>
                        Core Processes Guide
                    </h2>
                </td>
                <td>
                    &nbsp;
                </td>
            </tr>
        </table><br>
        <table>
            <tr>
                <td>
                    <br>
                    <b>Intended Audience :</b><br>
                    <ul>
                        <li>Configurator / Business Analyst / Salesforce System Administrator
                        </li>
                        <li>Force.com Apex Developers
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    <b>About This Guide :</b><br>
                    <ul>
                        <li>The purpose of this guide is to explain the use and configuration of
                            every pre-packaged process in the ESB framework .
                        </li>
                        <li>This guide does not cover designing building and deploying custom ESB processes. 
                            <br/> That topic is described in the separate 
                            <a href="./ProcessDevelopersGuide.html" style="color: #00f;">Process Developer's
                                Guide</a> guide.
                        </li>
                        <li>This guide does not cover configuring or monitoring the Enterprise Service Bus.
                            <br/> That topic is described in the separate 
                            <a href="./OrchestratorsGuide.html" style="color: #00f;">Orchestrator's Guide</a>
                            guide.
                        </li>
                    </ul><br>
                    <br>
                </td>
            </tr>
            <tr>
                <td>
                    <b>Overview :</b><br>
                    <ul>
                        <li>The ESB framework  has 12 pre-packaged ESB processes.
                        </li>
                        <li>These pre-packaged processes are classified under the group 
                            "Event Driven Architecture".
                        </li>
                        <li>Some processes work in isolation (for example <code>Wiretap</code> )
                            while other processes work in tandem (for example <code>Publish</code> and
                            <code>Subscribe</code>)
                        </li>
                        <li>Note that some processes are no-operation or pass-through in nature.
                            <br/>In other words these no-op processes simply forward all received messages to
                            the next step in their respective Sequence
                        </li>
                    </ul>
                </td>
            </tr>
        </table>
        <table>
            <tr>
                <td>
                    <img src="./CoreProcessesGuide/Terminate.png" style="vertical-align:middle;">
                    <b>Terminate :</b><br>
                    <ul>
                        <li>Every Sequence must have a <code>Terminate</code> process.
                        </li>
                        <li>A <code>Terminate</code> process is automatically inserted as a sequence
                            step when a processing sequence is first created.
                        </li>
                        <li>It is the ESB configurator's responsibility to ensure that the
                            <code>Terminate</code> process is the final step in any processing sequence.
                       <br/> <b>Note:</b>
                            Any processes that follow the termination step in a sequence will not be
                            executed.
                        </li>
                    </ul>
                </td>
            </tr>
        </table>
        <table>
            <tr>
                <td>
                    <img src="./CoreProcessesGuide/Wiretap.png" style="vertical-align:middle;">
                    <b>Wiretap :</b><br>
                    <ul>
                        <li>A <code>Wiretap</code> process is a pass through process that also emails the
                            details of an inbound message to an interested user.
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="extra-details">
                   
                    <b>Customization and Configuration :</b><br>
                    <ul>
                        <li>The email will be sent to the user under which the ESB framework
                            is running.
                        </li>
                        <li>Alternatively, a specific user can be nominated to receive these emails.
                        </li>
                        <li>To specify the <code>Wiretap</code> recipient, select the
                            <code>Wiretap</code> process from the list of processes and on the detailed
                            view, click the <code>View Settings</code> button.
                        </li>
                        <li>Clicking the <code>View Settings</code> button will redirect the to the
                            <code>WireTap Custom Settings</code> view
                        </li>
                        <li>On the <code>WireTap Custom Settings</code> view, enter the <code>User
                            Id</code> of the nominated user that will receive wiretap emails.
                        </li>
                    </ul>
                    </div>
                </td>
            </tr>
        </table>
        
        <br/>
        
        <table>
            <tr>
                <td>
                    <img src="./CoreProcessesGuide/AuditWriter.png" style="vertical-align:middle;">
                    <b>AuditWriter :</b><br>
                    <img src="./CoreProcessesGuide/AuditInitializer.png" style="vertical-align:middle;"> 
                    <b>AuditInitializer :</b><br>
                    <ul>
                        <li>The <code>AuditWriter</code> and <code>AuditInitializer</code>
                            processes work together.
                            <br/> This allows the relationship between  data at various 
                            steps in one or more sequence(s) to be presented under a meaningful 
                            and common grouping reference key
                        </li>
                        <li>The <code>AuditInitializer</code> process defines a new business grouping
                            key.
                        </li>
                        <li>A message passing through a <code>AuditInitializer</code> process will
                            have it's state persisted  downstream whenever that same
                            message passes through  a subsequent <code>AuditWriter</code> process
                           <br/> <b>Note:</b>
                             A message passing through a  <code>AuditInitializer</code> process results in the  
                            creation of a business grouping key.
                            <br/> Downstream <code>AuditWriter</code> processes will 
                             persist the  state of the message under that business grouping key.
                        </li>
                        
                        <li>A message can carry more than one business grouping key. 
                            <br/>In such cases , the <code>AuditWriter</code> process will persist a message under
                            every business grouping key found in the message
                        </li>
                    </ul>

                    <div class="extra-details">
                    A business grouping key is a composite of :
                    <ul>
                        <li>A Time Stamp
                        </li>
                        <li>A Business Identifier
                        </li>
                    </ul>
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="extra-details">
               
                    <b>Customization and Configuration :</b> The business identifier (the non-time
                    stamp portion of the business grouping key described above) can be configured
                    in be one of the three ways:
                    <br/>
                    <br/>
                    <b>Implicit configuration :</b>
                  
                    <ul>
                        <li>This is the default mechanism for defining the business identifier and is
                            used when no explicit definition has been configured on the
                            <code>AuditInitializer</code> process.
                        </li>
                        <li>Under this mode, the business identifier will be a composite of the
                            <code>AuditInitializer</code>'s sequence name and sequence position
                        </li>
                        <li>For example, a <code>AuditInitializer</code> placed as the second step in a
                            sequence named <code>'Test'</code> will auto-configure itself to generate the
                            business identifier <code>'Test-2'</code>.
                        </li>
                    </ul>
                 
                    <b>Static Configuration :</b>
                  
                    <ul>
                        <li>To specify the a static business identifier , click the configure link
                            next to a <code>AuditInitializer</code> process
                        </li>
                        <li>Clicking the configure link will surface the configuration screen for the
                            <code>AuditInitializer</code> process
                        </li>
                        <li>Click the <img src="./CoreProcessesGuide/Edit.png"
                                           style="vertical-align:middle;"> button.
                        </li>
                        <li>In the Static Group Identifier field, enter a meaningful static value (eg
                            <code>INVOICE</code> or <code>WEB-DATA</code>) which will form the grouping
                            identifier.
                        </li>
                        <li>Click the <img src="./CoreProcessesGuide/Save.png" 
                                           style="vertical-align:middle;"> button.
                        </li>
                        <li>For example, a <code>AuditInitializer</code> with the value
                            <code>'PAY-SLIP'</code> will generate the business identifier
                            <code>'PAY-SLIP'</code>.
                        </li>
                    </ul>
                 
                    <b>Dynamic Configuration :</b>
               
                    <ul>
                        <li>To specify a dynamic business identifier , click the configure link next
                            to a <code>AuditInitializer</code> process.
                        </li>
                        <li>Clicking the configure link will surface the configuration screen for the
                            <code>AuditInitializer</code> process.
                        </li>
                        <li>Click the <img src="./CoreProcessesGuide/ChangeDynamicGroupIdentifier.png" 
                                           style="vertical-align:middle;"> button. 
                            This will surface an <code>SObject</code>
                            field selector screen.
                        </li>
                        <li>Using the picklist, select the <code>SObject</code> and related
                            <code>SObject</code> field that define the data source for the dynamic
                            business identifier.<br>
                            <b>for example:</b> selecting <code>Account</code> and then
                            <code>NaicsCode</code> configures the <code>AuditInitializer</code> process
                            to perform the following steps at runtime:
                            <ol>
                                <li>inspect the contents of underlying data passing through the process
                                </li>
                                <li>extract the value of the <code>NaicsCode</code> from the contents of
                                    underlying data (the dynamic business key)
                                </li>
                                <li>create a business grouping identifier using the dynamically derived
                                    business key derived under step 2.
                                </li>
                            </ol><b>note:</b> It is the system designer's responsibility to ensure that
                            the selected <code>SObject</code> field will align with underlying data
                            passing through the sequence.
                        </li>
                        <li>A message passing through a dynamically configured
                            <code>AuditInitializer</code> process will have its underlying data inspected
                            and the value of this dynamic field extracted.
                        </li>
                    </ul>
                    </div>
                </td>
 
            </tr>
            <tr>
                <td>
                    <div class="extra-details">
                    <br>
                    <b>Usage Example:</b> see <a href="./LogUnderCommonIdentifierTutorial.html"
                                                 style="color: #00f;">Log Under Common Identifier, Tutorial 03</a><br>
                    </div>    
                </td>
            </tr>
        </table>
        
        <br/><br/>
        
        <table>
            <tr>
                <td>
                    <img src="./CoreProcessesGuide/Publish.png" 
                         style="vertical-align:middle;">
                    <b>Publish :</b><br>
                    <img src="./CoreProcessesGuide/Subscribe.png" 
                         style="vertical-align:middle;">
                    <b>Subscribe :</b><br>
                    <ul>
                        <li>The <code>Publish</code> and <code>Subscribe</code> processes work 
                            together to bind two or more sequences.
                        </li>
                        <li>This binding is achieved by specifying a common Named Event that is
                            shared between both the <code>Publish</code> and <code>Subscribe</code>
                            processes. 
                        </li>
                        <li>The <code>Publish</code> process directs the message to the common named
                            event and the <code>Subscribe</code> process retrieves from the common Named
                            Event.
                        </li>
                        <li>This indirection facilitates the retrieval of
                            the same Named Event by
                            more than one <code>Subscribe</code> process.
                        </li>
                        <li>
                            A <code>Subscribe</code> process must always be the first
                            process in a Sequence
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="extra-details">
                   
                    <b>Customization and Configuration :</b><br>
                    <ul>
                        <li>A named event must be specified for both the <code>Subscribe</code> and
                            <code>Publish</code> processes.
                        </li>
                        <li>A named event is created from the configuration screen of either the
                            <code>Publish</code> or <code>Subscribe</code> processes
                        </li>
                        <li>To specify the named event , click the configure link next to either a
                            <code>Publish</code> or <code>Subscribe</code> Sequence step
                        </li>
                        <li>Clicking the configure link will redirect to the configuration view
                        </li>
                        <li>On the configuration view, click the 
                            <img src="./CoreProcessesGuide/ManageEventTypes.png" 
                                 style="vertical-align:middle;">
                            button and then click the <img src="./CoreProcessesGuide/NewEventType.png"
                                                           style="vertical-align:middle;">
                            button to create a new named event
                        </li>
                        <li>To publish to a named event, click the configure link next to a
                            <code>Publish</code> Sequence step (if not already on the
                            <code>Publish</code> configuration view) .
                        </li>
 
                        <li>Select a named event to publish to by clicking the <code>Event
                            Type</code> lookup field.
                        </li>
                        <li>To subscribe to a named event, click the configure link next to a <code>
                            Subscribe</code> Sequence step (if not already on the
                            <code>Subscribe</code> configuration view)
                        </li>

                        <li>Select a named event to subscribe to by clicking the <code>Event
                            Type</code> lookup field.
                        </li>
                    </ul>
                    </div>
                </td>
            </tr>
        </table>
        
        <br/>
        
        <table>
            <tr>
                <td>
                    <img src="./CoreProcessesGuide/Mark.png" style="vertical-align:middle;">
                    <b>Mark :</b><br>
                    <img src="./CoreProcessesGuide/Gate.png" style="vertical-align:middle;">
                    <b>Gate :</b><br>
                    <ul>
                        <li>A <i>related</i> collection of messages may proceed down different execution paths.
                        </li>
                        <li>A need may still arise for a  process to act on these <i>related</i> messages in a single
                            transaction context 
                            <br/> ( even though one (or more) of these messages may have
                            proceeded down different paths).
                        </li>
                        <li>A pattern that handles the above scenario is commonly known as a "Saga".
                        </li>


                        <li style="list-style: none">
                        <br/>
                        </li>


                        <li>A <code>Shipping</code> Service is a typical example of a Saga.
                            <ul>
                                <li>From the perspective of the ESB framework, consider a
                                    <code>Shipping</code> sequence that begins with a
                                    <code>Customer-Order</code> message.
                                </li>
                                <li>The <code>Shipping</code> sequence will typically reach out to two
                                    helper sequences : a <code>Bill-Customer</code> sequence and an
                                    <code>Accept-Order</code> sequence.
                                </li>
                                <li>These two (sub)sequences will asynchronously report back to the
                                    <code>Shipping</code> sequence via a <code>Customer-Billed</code> message
                                    and an <code>Order-Accepted</code> message.
                                </li>
                                <li>Unfortunately, the arrival order of these two asynchronous messages
                                    is unknown until runtime.
                                </li>
                                <li>For this reason, the <code>Shipping</code> sequence will need to <i>
                                    hold up</i> and not release the <code>Customer-Order</code> message
                                    until until BOTH the
                                    <ul>
                                        <li>
                                            <code>Customer-Billed</code> and
                                        </li>
                                        <li>
                                            <code>Order-Accepted</code>
                                        </li>
                                    </ul>messages have returned to the <code>Shipping</code> sequence.
                                </li>
                            </ul>
                        </li>

                        <li style="list-style: none">
                            <br/>
                        </li>

                        <li>Using the above example, the ESB framework would
                            <ul>
                                <li>make use of a <code>Mark</code> process immediately prior to a custom
                                    <code>Dispatcher</code> process
                                </li>
                                <li>the custom written <code>Dispatcher</code> process would fan out the
                                    <code>Customer-Order</code> message as
                                    <ul>
                                        <li>a <code>Customer-Billed</code> message to the
                                            <code>Bill-Customer</code> sequence and
                                        </li>
                                        <li>a <code>Order-Accepted</code> message to the
                                            <code>Accept-Order</code> sequence.
                                        </li>
                                    </ul>
                                </li>
                                <li>A <code>Gate</code> process would be placed after the
                                    <code>Dispatcher</code> process to buffer the returned
                                    <code>Customer-Billed</code> and <code>Order-Accepted</code> messages.
                                </li>
                                <li>This <code>Gate</code> process would release the
                                    <code>Customer-Order</code> message after receiving both the
                                    <code>Customer-Billed</code> and <code>Order-Accepted</code> messages
                                </li>
                            </ul>
                        </li>


                        <li style="list-style: none">
                            <br/>
                        </li>


                        <li>In summary, the ESB framework uses
                            <ul>
                                <li>a <code>Mark</code> process and a <code>Gate</code> process in tandem
                                    to implement a Saga.
                                </li>
                                <li>First, the <code>Mark</code> process annotates a message suggesting
                                    it (and the messages it subsequently spawns) will be used in a saga.
                                </li>
                                <li>Later, a downstream <code>Gate</code> process buffers and releases
                                    logically related messages.
                                </li>
                            </ul>
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="extra-details">
                    <b>Customization and Configuration :</b><br>
                    <ul>
                        <li>Insert a <code>Mark</code> process immediately before a fan-out process
                            in a Sequence.
                        </li>
                        <li>Insert a <code>Gate</code> process at some point after the fan-out
                            process
                        </li>
                    </ul>
                    </div>
                </td>
            </tr>
        </table>
        
        <br/>
        
        
        <table>
            <tr>
                <td>
                    <img src="./CoreProcessesGuide/SubSequence.png" style="vertical-align:middle;">
                    <b>SubSequence :</b><br>
                    <img src="./CoreProcessesGuide/Branch.png" style="vertical-align:middle;">
                    <b>Branch :</b><br>
                    <img src="./CoreProcessesGuide/Jump.png" style="vertical-align:middle;">
                    <b>Jump :</b><br>
                    <ul>
                        <li>Execution logic is often broken into two or more sequences.
                           <br/> A need therefore arises to connect the business logic contained in these sequences
                        </li>
                        <li>The <code>SubSequence</code>, <code>Branch</code> and <code>Jump</code>
                            processes allow messages to transition between sequences
                       
                        <ul>
                            <li>The <code>Jump</code> process directs execution flow to the first step in
                                an alternative sequence.
                                <br>
                                <b>Note:</b>
                                Steps in the current sequence following a <code>Jump</code> step will not be
                                executed
                            </li>
                            <li>The <code>Branch</code> process directs execution flow to the first step
                                in an alternative sequence AND allows the remaining steps in the current
                                sequence to complete.
                                <br>
                                <b>Note:</b>
                                Unlike the <code>Jump</code> process, steps in the current sequence following a
                                <code>Branch</code> step will still be executed
                            </li>
                            <li>The <code>SubSequence</code> process directs execution flow to the first
                                step in an alternative sequence.
                                <br>
                                <b>Note:</b>
                                When execution reaches the <code>Terminate</code> step in the alternative
                                sequence, execution flow returns to the step immediately
                                following the <code>SubSequence</code> step of the current Sequence
                            </li>     
                        </ul>
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="extra-details">
                        <b>Customization and Configuration :</b><br>
                        <ul>
                            <li>To specify the sequence to jump to, click the configure link next to a
                                <code>Jump</code> sequence step.
                            </li>
                            <li>Clicking the configure link will redirect to the <code>Jump</code> configuration view
                            </li>
                            <li>In the sequence field, enter the name of the sequence to jump to .
                            </li>
                            <li style="list-style: none">
                                <br/>
                            </li>
                            <li>To specify the sequence to branch to, click the configure link next to a
                                <code>Branch</code> sequence step.
                            </li>
                            <li>Clicking the configure link will redirect to the <code>Branch</code> 
                                configuration view
                            </li>
                            <li>In the <code>sequence</code> field, enter the name of the sequence to
                                branch to.
                            </li>
                            <li style="list-style: none">
                                <br/>
                            </li>
                            <li>To specify the sequence to execute before returning, click the configure
                                link next to a <code>Subsequence</code> sequence step.
                            </li>
                            <li>Clicking the configure link will redirect to the <code>Subsequence</code>
                                configuration view
                            </li>
                            <li>In the <code>sequence</code> field, enter the name of the sequence to
                                execute.
                            </li>
                        </ul>
                    </div>
                </td>
            </tr>
        </table>
        
        <br/>
        
        <table>
            <tr>
                <td>
                    <img src="./CoreProcessesGuide/Schedule.png" style="vertical-align:middle;">
                    <b>Schedule :</b><br>
                    <ul>
                        <li>Certain events are time based.
                        </li>
                        <li>Time is a continuous flow but in reality, most systems are interested in
                            the occurrence of discreet time events such as 12:00 pm GMT, Monday.
                        </li>
                        <li>The <code>Schedule</code> process has a configurable schedule to register interest in
                            the occurrence of discrete future time based events. This register is called
                            a schedule.
                        </li>
                        <li>The <code>Schedule</code> process emits a message whenever a registered
                            scheduled event has occurred.
                        <br/>
                            <b>Note:</b> A <code>Schedule</code> process must be the first step
                            in a sequence.
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    <div class="extra-details">
                    <b>Customization and Configuration :</b><br>
                    <ul>
                        <li>To specify a schedule, click the configure link next to a Schedule
                           sequence step.
                        </li>
                        <li>Clicking the configure link will redirect to the Schedule configuration
                            view
                        </li>
                        <li>A schedule has one or more hourly time intervals defining when
                            the schedule should fire. 
                            <br/>The  schedule can be further filtered by frequency and
                            run dates.
                        </li>
                        <li>In the <code>Run Times</code>  field , select one or more hourly time intervals that
                            specify when the schedule should fire.<br>
                            (The framework assumes all times are specified in GMT with no reference to
                            Org or user's time zone settings.)
                        </li>
                        <li>In the <code>Frequency</code> field , select the frequency from
                            <code>Daily</code>, <code>Weekly</code> or <code>Monthly</code>. 
                            <br/>The value
                            selected defines the available values under the Run dates picklist
                        </li>
                    </ul>
                    </div>
                </td>
            </tr>
        </table>
    </body>
</html>