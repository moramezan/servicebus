

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><script src="/faces/a4j/g/3_3_3.Finalorg.ajax4jsf.javascript.AjaxScript?rel=1400083731000" type="text/javascript"></script><script src="/static/111213/js/perf/stub.js"></script><script src="/static/111213/js/functions.js" type="text/javascript"></script><script src="/jslibrary/1398894194000/sfdc/main.js" type="text/javascript"></script><script src="/jslibrary/jslabels/1399588760000/en_US.js" type="text/javascript"></script><script src="/static/111213/desktop/desktopAjax.js" type="text/javascript"></script><script src="/static/111213/js/picklist.js" type="text/javascript"></script><link class="user" href="/sCSS/30.0/sprites/1399588760000/Theme3/default/gc/zen-componentsCompatible.css" rel="stylesheet" type="text/css" /><link class="user" href="/sCSS/30.0/sprites/1399588760000/Theme3/default/gc/elements.css" rel="stylesheet" type="text/css" /><link class="user" href="/sCSS/30.0/sprites/1399588760000/Theme3/default/gc/common.css" rel="stylesheet" type="text/css" /><link class="user" href="/sCSS/30.0/sprites/1398193090000/Theme3/gc/dStandard.css" rel="stylesheet" type="text/css" /><link class="user" href="/sCSS/30.0/sprites/1400249746000/Theme3/00Db0000000d3oV/005b0000000vx4E/gc/dCustom0.css" rel="stylesheet" type="text/css" /><link class="user" href="/sCSS/30.0/sprites/1399588760000/Theme3/default/gc/extended.css" rel="stylesheet" type="text/css" /><link class="user" href="/sCSS/30.0/sprites/1399588760000/Theme3/default/gc/setup.css" rel="stylesheet" type="text/css" /></head><body>
    
    <style>
           body {background: url('./inPageClouds.png') top left no-repeat;}
           
           code {font-family: "Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace; font-size:112%;}
           .contact {font-family: "Courier New", Courier, "Lucida Sans Typewriter", "Lucida Typewriter", monospace; 
                     font-size:112%;
                     text-align:center}
            .contact.dot {font-weight:bold;}         
           a {text-decoration:none;}
    </style>

         <br /><script> if(!window.sfdcPage) { window.sfdcPage = new ApexPage(); }UserContext.initialize({"networkId":"","labelLastModified":"1399588760000","locale":"en_GB","isDefaultNetwork":true,"timeFormat":"HH:mm","today":"18/05/2014 22:15","orgPreferences":[{"index":257,"name":"TabOrganizer","value":true}],"userPreferences":[{"index":112,"name":"HideInlineEditSplash","value":false},{"index":114,"name":"OverrideTaskSendNotification","value":false},{"index":115,"name":"DefaultTaskSendNotification","value":false},{"index":119,"name":"HideUserLayoutStdFieldInfo","value":false},{"index":116,"name":"HideRPPWarning","value":false},{"index":87,"name":"HideInlineSchedulingSplash","value":false},{"index":88,"name":"HideCRUCNotification","value":false},{"index":89,"name":"HideNewPLESplash","value":false},{"index":90,"name":"HideNewPLEWarnIE6","value":false},{"index":122,"name":"HideOverrideSharingMessage","value":false},{"index":91,"name":"HideProfileILEWarn","value":false},{"index":93,"name":"HideProfileElvVideo","value":false},{"index":97,"name":"ShowPicklistEditSplash","value":false},{"index":92,"name":"HideDataCategorySplash","value":false},{"index":128,"name":"ShowDealView","value":false},{"index":129,"name":"HideDealViewGuidedTour","value":false},{"index":132,"name":"HideKnowledgeFirstTimeSetupMsg","value":false},{"index":104,"name":"DefaultOffEntityPermsMsg","value":false},{"index":135,"name":"HideNewCsnSplash","value":true},{"index":101,"name":"HideBrowserWarning","value":false},{"index":139,"name":"HideDashboardBuilderGuidedTour","value":false},{"index":140,"name":"HideSchedulingGuidedTour","value":false},{"index":180,"name":"HideReportBuilderGuidedTour","value":false},{"index":183,"name":"HideAssociationQueueCallout","value":false},{"index":194,"name":"HideQTEBanner","value":false},{"index":193,"name":"HideChatterOnboardingSplash","value":false},{"index":195,"name":"HideSecondChatterOnboardingSplash","value":false},{"index":270,"name":"HideIDEGuidedTour","value":true},{"index":282,"name":"HideQueryToolGuidedTour","value":true},{"index":196,"name":"HideCSIGuidedTour","value":true},{"index":271,"name":"HideFewmetGuidedTour","value":false},{"index":272,"name":"HideEditorGuidedTour","value":true},{"index":205,"name":"HideApexTestGuidedTour","value":false},{"index":206,"name":"HideSetupProfileHeaderTour","value":false},{"index":207,"name":"HideSetupProfileObjectsAndTabsTour","value":false},{"index":213,"name":"DefaultOffArticleTypeEntityPermMsg","value":false},{"index":214,"name":"HideSelfInfluenceGetStarted","value":false},{"index":215,"name":"HideOtherInfluenceGetStarted","value":false},{"index":216,"name":"HideFeedToggleGuidedTour","value":false},{"index":268,"name":"ShowChatterTab178GuidedTour","value":false},{"index":275,"name":"HidePeopleTabDeprecationMsg","value":false},{"index":276,"name":"HideGroupTabDeprecationMsg","value":false},{"index":224,"name":"HideUnifiedSearchGuidedTour","value":false},{"index":226,"name":"ShowDevContextMenu","value":true},{"index":227,"name":"HideWhatRecommenderForActivityQueues","value":false},{"index":228,"name":"HideLiveAgentFirstTimeSetupMsg","value":false},{"index":232,"name":"HideGroupAllowsGuestsMsgOnMemberWidget","value":false},{"index":233,"name":"HideGroupAllowsGuestsMsg","value":false},{"index":234,"name":"HideWhatAreGuestsMsg","value":false},{"index":235,"name":"HideNowAllowGuestsMsg","value":false},{"index":236,"name":"HideSocialAccountsAndContactsGuidedTour","value":false},{"index":237,"name":"HideAnalyticsHomeGuidedTour","value":false},{"index":238,"name":"ShowQuickCreateGuidedTour","value":false},{"index":245,"name":"HideFilePageGuidedTour","value":false},{"index":250,"name":"HideForecastingGuidedTour","value":false},{"index":251,"name":"HideBucketFieldGuide","value":false},{"index":263,"name":"HideSmartSearchCallOut","value":false},{"index":265,"name":"HideSocialProfilesKloutSplashScreen","value":false},{"index":273,"name":"ShowForecastingQuotaAttainment","value":false},{"index":280,"name":"HideForecastingQuotaColumn","value":false},{"index":301,"name":"HideManyWhoGuidedTour","value":false},{"index":284,"name":"HideExternalSharingModelGuidedTour","value":false},{"index":298,"name":"HideFileSyncBannerMsg","value":false},{"index":299,"name":"HideTestConsoleGuidedTour","value":false},{"index":300,"name":"HideNetworkSetupOverlayGettingStarted","value":false},{"index":302,"name":"HideManyWhoInlineEditTip","value":false},{"index":303,"name":"HideSetupV2WelcomeMessage","value":false},{"index":312,"name":"ForecastingShowQuantity","value":false},{"index":313,"name":"HideDataImporterIntroMsg","value":false},{"index":314,"name":"HideEnvironmentHubLightbox","value":false},{"index":316,"name":"HideSetupV2GuidedTour","value":false},{"index":317,"name":"HideFileSyncMobileDownloadDialog","value":false},{"index":318,"name":"HideHelpBannerQuickActionList","value":false},{"index":321,"name":"HideCustomEntityQuickActionCallout","value":true},{"index":322,"name":"HideEnhancedProfileHelpBubble","value":false},{"index":328,"name":"ForecastingHideZeroRows","value":false},{"index":330,"name":"HideEmbeddedComponentsFeatureCallout","value":true},{"index":341,"name":"HideDedupeMatchResultCallout","value":false},{"index":340,"name":"HideS1BrowserUI","value":false}],"startOfWeek":"2","isAccessibleMode":false,"ampm":["AM","PM"],"renderMode":"RETRO","userId":"005b0000000vx4E","dateTimeFormat":"dd/MM/yyyy HH:mm","dateFormat":"dd/MM/yyyy","uiSkin":"Theme3","language":"en_US","siteUrlPrefix":""});
</script><div class="apexp"><div id="j_id0:j_id2" class="bPageBlock brandSecondaryBrd bDetailBlock secondaryPalette"><div class="pbHeader"><table border="0" cellpadding="0" cellspacing="0"><tr><td class="pbTitle"><h2 class="mainTitle">Tutorial : Regularly Scrape a Web Page</h2></td><td>&nbsp;</td></tr></table></div><div class="pbBody">

         <br /><div id="j_id0:j_id2:j_id4"><div class="pbSubheader brandTertiaryBgr first tertiaryPalette"><h3>Objective :</h3></div><div class="pbSubsection"><table class="detailList" border="0" cellpadding="0" cellspacing="0"><tr><td class="data2Col  first " colSpan="2">
               <ul>
                    <p>A common requirement is the ability to retrieve data from an external source as and when it changes.
                       <br />In Salesforce, there is no native mechanism for easily detecting and acting on such changes.
                       <br />Consider for example, retrieving and saving a particular stock's  updated price data from a financial web site. 
                    </p>
                    <p>This tutorial will demonstrate how Event Driven Architecture can easily simulate changed stock price events by polling <a href="http://finance.yahoo.com" style="color: #00f;" target="_blank">Yahoo Finance</a>  .
                    </p> 
                </ul></td></tr><tr><td class="data2Col  last " colSpan="2">
                    <p><b>Expected Duration : </b> 25 Minutes.</p></td></tr></table></div></div><div id="j_id0:j_id2:j_id9"><div class="pbSubheader brandTertiaryBgr tertiaryPalette"><h3>Scenario :</h3></div><div class="pbSubsection"><table class="detailList" border="0" cellpadding="0" cellspacing="0"><tr><td class="data2Col  first  last " colSpan="2">
                    <p> <b> Requirement : </b> 
                        <ul>
                        <li>At least four times a day retrieve  the price data of your favourite stock  which is of course <a href="http://finance.yahoo.com/q?s=CRM" style="color: #00f;" target="_blank">CRM</a>   (Salesforce).
                        </li>
                        </ul>
                    </p> 
                    <p>  <b> Implementation Overview :</b> 
                         <ul>
                         <li>Configure a 
                              <b>[</b> <img src="./ScrapeWebPageTutorial/Schedule.png" style="vertical-align:middle;" /> <b>]</b> 
                              process to fire  four times a day.
                         </li>
                         <li>Configure a
                             <b>[</b> <img src="./ScrapeWebPageTutorial/Scrape.png" style="vertical-align:middle;" /> <b>]</b> 
                             process to retrieve the contents of  
                             <span style="color: #00f;">http://finance.yahoo.com/q?s=CRM</span>  .
                         </li>
                         <li> Simulate engaging the services of a Force.com developer to create a custom stock parsing process <b>[</b> <img src="./ScrapeWebPageTutorial/StockParse.png" style="vertical-align:middle;" /> <b>]</b>.
                              <br /> ( This process will extract CRM price data into a json structure ).
                         </li>
                         </ul>
                    </p>  
                    <p> <b> Testing :</b> 
                         <ul>
                         <li> Insert a   <b>[</b> <img src="./ScrapeWebPageTutorial/Wiretap.png" style="vertical-align:middle;" /> <b>]</b>  
                              process towards the end the <code>Sequence</code>.
                         </li>
                         <li>Enqueue a test message.
                         </li>
                         <li>Inspect the output of this process to confirm that the <code>Sequence</code> is correctly configured.
                          </li>
                          </ul>
                    </p></td></tr></table></div></div><div id="j_id0:j_id2:j_id12"><div class="pbSubheader brandTertiaryBgr tertiaryPalette"><h3>Prerequisites :</h3></div><div class="pbSubsection"><table class="detailList" border="0" cellpadding="0" cellspacing="0"><tr><td class="data2Col  first  last " colSpan="2">
                    <ul>
                         <li> Confirm that the EDA environment is correctly setup by completing
                              <a href="./ConfirmSetupTutorial.html" style="color: #00f;">Tutorial 01</a>   
                         </li>
                         <li> Ensure that your test Org has a compiled version of the <code> EdaUtility </code> Apex class - see
                              <a href="./ProcessDevelopersGuide.html" style="color: #00f;">Process Developer's Guide, APPENDIX II </a>
                         </li>
                      </ul></td></tr></table></div></div><div id="j_id0:j_id2:j_id15"><div class="pbSubheader brandTertiaryBgr tertiaryPalette"><h3>Detailed Instructions :</h3></div><div class="pbSubsection"><table class="detailList" border="0" cellpadding="0" cellspacing="0"><tr><td class="data2Col  first  last " colSpan="2">
                <ol>         
                    <li> Create and register the Yahoo <b>[</b> <img src="./ScrapeWebPageTutorial/StockParse.png" style="vertical-align:middle;" /> <b>]</b> process. 
                         <br />Create a new apex class by clicking <b>  Setup|Develop|Apex Classes|New </b>
                         <br /><br /> Paste  and save the following code :
                        
                         <br /> <br />
 
<div style="background: #ffffff; overflow:auto;width:60%;border:solid gray;border-width:.1em .1em .1em .1em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">

<span style="color: #008800; font-weight: bold">public</span> with sharing <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">StockParse</span> <span style="color: #008800; font-weight: bold">implements</span> Process<span style="color: #333333">.</span><span style="color: #0000CC">Plugin</span> <span style="color: #333333">{</span>                                                       
                                                                                                   
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">StockParseException</span> <span style="color: #008800; font-weight: bold">extends</span> Exception <span style="color: #333333">{}</span>                                                              
                                                                                                       
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Meta</span> <span style="color: #333333">{</span>                                                                                                                             
        <span style="color: #008800; font-weight: bold">public</span> String icon <span style="color: #333333">=</span> <span style="background-color: #fff0f0">'wrench'</span><span style="color: #333333">;</span>                                                                                
    <span style="color: #333333">}</span>                                                                                                                  
                                                                                                       
    <span style="color: #008800; font-weight: bold">public</span> Process<span style="color: #333333">.</span><span style="color: #0000CC">PluginDescribeResult</span> <span style="color: #0066BB; font-weight: bold">describe</span><span style="color: #333333">()</span> <span style="color: #333333">{</span>                                                                   
        Process<span style="color: #333333">.</span><span style="color: #0000CC">PluginDescribeResult</span> describeResult <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Process<span style="color: #333333">.</span><span style="color: #0000CC">PluginDescribeResult</span><span style="color: #333333">();</span>                              
        describeResult<span style="color: #333333">.</span><span style="color: #0000CC">Name</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">'StockParse'</span><span style="color: #333333">;</span>                                                                            
        describeResult<span style="color: #333333">.</span><span style="color: #0000CC">Description</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">'Extacts stock price from Yahoo Finance page content'</span><span style="color: #333333">;</span>              
        describeResult<span style="color: #333333">.</span><span style="color: #0000CC">Tag</span> <span style="color: #333333">=</span> <span style="background-color: #fff0f0">'Example'</span><span style="color: #333333">;</span>                                                                                
        <span style="color: #008800; font-weight: bold">return</span> describeResult<span style="color: #333333">;</span>                                                                                         
    <span style="color: #333333">}</span>                                                                                                                  
                                                                                                       
    <span style="color: #008800; font-weight: bold">public</span> Process<span style="color: #333333">.</span><span style="color: #0000CC">PluginResult</span> <span style="color: #0066BB; font-weight: bold">invoke</span><span style="color: #333333">(</span>Process<span style="color: #333333">.</span><span style="color: #0000CC">PluginRequest</span> request<span style="color: #333333">)</span> <span style="color: #333333">{</span>                                                
        Map<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span>Object<span style="color: #333333">&gt;</span> parameters <span style="color: #333333">=</span> request<span style="color: #333333">.</span><span style="color: #0000CC">inputParameters</span><span style="color: #333333">;</span>                                                       
       
        <span style="color: #888888">//retrieve (yahoo finance) page content as a Blob</span>
        Id dataId <span style="color: #333333">=</span> <span style="color: #333333">(</span>Id<span style="color: #333333">)</span> parameters<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'Id'</span><span style="color: #333333">);</span>   
        List<span style="color: #333333">&lt;</span>Attachment<span style="color: #333333">&gt;</span> attachments <span style="color: #333333">=</span> <span style="color: #333333">[</span>SELECT Body FROM Attachment WHERE Id <span style="color: #333333">=</span> <span style="color: #333333">:</span>dataId<span style="color: #333333">];</span> 
        <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>attachments<span style="color: #333333">.</span><span style="color: #0000CC">size</span><span style="color: #333333">()</span> <span style="color: #333333">==</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
            <span style="color: #008800; font-weight: bold">throw</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">StockParseException</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'Unable to load yahoo finance page content'</span><span style="color: #333333">);</span>
        <span style="color: #333333">}</span> 
        Attachment attachment <span style="color: #333333">=</span> attachments<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">];</span>  
         
        <span style="color: #888888">// parse out ticker and price                                                                                        </span>
        String data  <span style="color: #333333">=</span>  attachment<span style="color: #333333">.</span><span style="color: #0000CC">Body</span><span style="color: #333333">.</span><span style="color: #0000CC">toString</span><span style="color: #333333">().</span><span style="color: #0000CC">replaceAll</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'\n'</span><span style="color: #333333">,</span><span style="background-color: #fff0f0">''</span><span style="color: #333333">).</span><span style="color: #0000CC">replaceAll</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">' '</span><span style="color: #333333">,</span><span style="background-color: #fff0f0">''</span><span style="color: #333333">)</span> <span style="color: #333333">;</span>
        String price <span style="color: #333333">=</span> data<span style="color: #333333">.</span><span style="color: #0000CC">substringAfter</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'class="time_rtq_ticker"&gt;'</span><span style="color: #333333">).</span><span style="color: #0000CC">substringBefore</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'&lt;/span&gt;'</span><span style="color: #333333">).</span><span style="color: #0000CC">substringAfter</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'&gt;'</span><span style="color: #333333">);</span>
        String ticker <span style="color: #333333">=</span> data<span style="color: #333333">.</span><span style="color: #0000CC">substringAfter</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'symbol='</span><span style="color: #333333">).</span><span style="color: #0000CC">substringBefore</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">';'</span><span style="color: #333333">);</span>                                                                                
        data <span style="color: #333333">=</span> <span style="background-color: #fff0f0">'{"Stock__c":  [ {"ticker__c": "'</span><span style="color: #333333">+</span>ticker<span style="color: #333333">+</span><span style="background-color: #fff0f0">'", "price__c": '</span><span style="color: #333333">+</span>price<span style="color: #333333">+</span><span style="background-color: #fff0f0">'} ] }'</span><span style="color: #333333">;</span>


        <span style="color: #888888">//updates:</span>
        <span style="color: #888888">//(1) blob with json ticker/price structure                                                                                    </span>
        attachment<span style="color: #333333">.</span><span style="color: #0000CC">Body</span> <span style="color: #333333">=</span> Blob<span style="color: #333333">.</span><span style="color: #0000CC">valueOf</span><span style="color: #333333">(</span>data<span style="color: #333333">);</span> 
        update attachment<span style="color: #333333">;</span> 
        
        <span style="color: #888888">//(2) surface price data as a parameter on message for demo purposes</span>
        parameters<span style="color: #333333">.</span><span style="color: #0000CC">put</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'priceData'</span><span style="color: #333333">,</span>data<span style="color: #333333">);</span>
        
                                                                     
        <span style="color: #008800; font-weight: bold">return</span> EdaUtility<span style="color: #333333">.</span><span style="color: #0000CC">convert</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> List<span style="color: #333333">&lt;</span>Map<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span>Object<span style="color: #333333">&gt;&gt;{</span>parameters<span style="color: #333333">});</span>                                         
    <span style="color: #333333">}</span>                                                                                                                
<span style="color: #333333">}</span>

</pre></div>



                    </li>
                    
                    <br /><br /><br />
                    
                    <li> Click on the list view of the <img src="./ScrapeWebPageTutorial/Processes.png" style="vertical-align:middle;" /> tab.
                         <br /> Click the  <img src="./ScrapeWebPageTutorial/Discover.png" style="vertical-align:middle;" />  
                               button so that the EDA framework dicovers and includes the recently created
                               <b>[</b> <img src="./ScrapeWebPageTutorial/StockParse.png" style="vertical-align:middle;" /> <b>]</b> 
                               process.
                         <br /> For futher details, refer to the 
                         <a href="./ProcessDiscoveryTutorial.html" style="color: #00f;">Process Discovery Tutorial</a>.
                     </li>
                    <br />
                    
                    <li> Set up a remote site for the Yahoo finance domain.
                         <br /> Cick <b> Setup|Security Controls|RemoteSite Settings </b> and enter the  Remote Site URL <a href="http://finance.yahoo.com ">http://finance.yahoo.com </a>   </li>                   
                         <br /> 
                         <img src="./ScrapeWebPageTutorial/RemoteSiteDetails.png" style="vertical-align:middle;" /> 
                         <br /> <br /><br />
                    
                    <li> Create a new <code>Sequence</code>.
                          <br /> Click the 
                                <img src="./ScrapeWebPageTutorial/EventDrivenArchitectureApplication.png" style="vertical-align:middle;" /> 
                                application  , select the 
                                <img src="./ScrapeWebPageTutorial/Sequences.png" style="vertical-align:middle;" />  
                                tab . 
                         <br />Then click [ New ] and name the new sequence  <code>WebScrape</code>. 
                         <br />Finally click [ Save ] 
                         <br />You will be presented with a new sequence that includes a default 
                              <b>[</b> <img src="./ScrapeWebPageTutorial/Terminate.png" style="vertical-align:middle;" />  <b>]</b> 
                              process.  
                    </li> 
                          
                    <br /><br /><br />
                    

                    <li> Add <code>Process Steps</code> to the Sequence.
                         <br />Click  the 
                              <img src="./ScrapeWebPageTutorial/NewStep.png" style="vertical-align:middle;" />  
                               repeatedly :  
                         <br />&nbsp; &nbsp; &nbsp; - From the <b>[</b> <img src="./ScrapeWebPageTutorial/ExtEda.png" style="vertical-align:middle;" />  <b>]</b> tab , select a <b>[</b> <img src="./ScrapeWebPageTutorial/Schedule.png" style="vertical-align:middle;" />  <b>]</b> process,  a  <b>[</b> <img src="./ScrapeWebPageTutorial/Wiretap.png" style="vertical-align:middle;" /> <b>]</b>  and a <b>[</b> <img src="./ScrapeWebPageTutorial/Publish.png" style="vertical-align:middle;" />  <b>]</b> process
                         <br />&nbsp; &nbsp; &nbsp; - From the <b>[</b> <img src="./ScrapeWebPageTutorial/ExtSample.png" style="vertical-align:middle;" />  <b>]</b> tab , select a  <b>[</b> <img src="./ScrapeWebPageTutorial/Scrape.png" style="vertical-align:middle;" />  <b>]</b> process
                         <br />&nbsp; &nbsp; &nbsp; - From the <b>[</b> <img src="./ScrapeWebPageTutorial/ExtExample.png" style="vertical-align:middle;" />  <b>]</b>  tab select a <b>[</b> <img src="./ScrapeWebPageTutorial/StockParse.png" style="vertical-align:middle;" />  <b>]</b> process.
                    </li>
                    
                    <br /><br /><br />
                    
                    <li> Arrange the <code>Process Steps</code>.
                        <br /> Arrange the process steps in the following order: 
                        <br /> <br />
                        <img src="./ScrapeWebPageTutorial/Sequence.png" style="vertical-align:middle;" /> 
                        <br /> <br />
                    </li>
                    
                    <br /><br /><br />
                    
                    <li> Configure the <code>Schedule</code> process.
                         <br />Click the  
                              <img src="./ScrapeWebPageTutorial/ConfigureLink.png" style="vertical-align:middle;" />  
                              link next to the 
                              <b>[</b> <img src="./ScrapeWebPageTutorial/Schedule.png" style="vertical-align:middle;" />  <b>]</b> 
                               process and set the schedule to fire an arbitrary number of times  during weekdays.
                         <br /> (<b>Note</b> : Care should be taken to align scheduled times with trading hours of the New York Stock Exchange after accounting for time zone differences)
                         <br /> 
                         <img src="./ScrapeWebPageTutorial/ScheduleConfigurationComplete.png" style="vertical-align:middle;" /> 
                         <br /> 
                         <br />Click [Save] and  exit the configure screen.
                    </li>
                    
                    <br /><br /><br />
                    
                    <li> Configure the <code>Scrape</code> process.
                         <br />Click the  
                          <img src="./ScrapeWebPageTutorial/ConfigureLink.png" style="vertical-align:middle;" />  
                          link next to the <b>[</b> <img src="./ScrapeWebPageTutorial/Scrape.png" style="vertical-align:middle;" />  <b>]</b> 
                          process  and 
                          <span style="color: #00f;">http://finance.yahoo.com/q?s=CRM</span> 
                          as the endpoint. 
                         <br />Click [Save] and  exit the configure screen.
                    </li>
                    
                    <br /><br /><br />
                    
                    <li> Create a <code>Named Event</code> type.
                         <br />An Event Type is simply a moniker that is shared between the  
                              <b>[</b> <img src="./ScrapeWebPageTutorial/Publish.png" style="vertical-align:middle;" /> <b>]</b>
                              and 
                              <b>[</b> <img src="./ScrapeWebPageTutorial/Subscribe.png" style="vertical-align:middle;" /> <b>]</b>
                              processes 
                         <br />(An Event Type represents a common bridge that can be published  or subscribed to)
                         <br />
                         <br />Click the  <img src="./ScrapeWebPageTutorial/ConfigureLink.png" style="vertical-align:middle;" />  
                             link next to the 
                             <b>[</b> <img src="./ScrapeWebPageTutorial/Publish.png" style="vertical-align:middle;" />  <b>]</b> 
                             process.
                         <br />Create  an <code>Event Type</code> to publish to - name it <code>YAHOO</code> to reflect the nature of the message being published. 
                         <br />Click the 
                             <img src="./ScrapeWebPageTutorial/ManageEventTypes.png" style="vertical-align:middle;" />  
                             button , click the 
                             <img src="./ScrapeWebPageTutorial/NewEventType.png" style="vertical-align:middle;" /> 
                             button and in the<code>Event Type</code> name insert the value <code>YAHOO</code>. 
                         <br />Finally click [ Save ].
                    </li>
 
                    <br /><br /><br />
                    
                    <li> Configure the <code>Publish</code> process.
                         <br />From the <code>Publish</code> configuration, assign the recently created <code>YAHOO</code> event type in the event type lookup field. 
                         <br />
                         <img src="./ScrapeWebPageTutorial/PublishConfigurationYahoo.png" style="vertical-align:middle;" /> 
                         
                         <br /> Click [ Save ] to return to the 
                               <img src="./ScrapeWebPageTutorial/Sequences.png" style="vertical-align:middle;" />  
                               page.
                    </li>
                    
                    <br /><br /><br />
                    
                    <li> Test the Sequence.
 
                         <br />To test this sequence,  enqueue a message  by pressing the
                        <img src="./Sequence/injectTestMessage.png" style="vertical-align:middle;" />
                         button
                         <br />(<b>Note</b> : under production conditions, one or more polling messages will be enqueued as defined in the configuraton of the 
                         <b>[</b> <img src="./ScrapeWebPageTutorial/Schedule.png" style="vertical-align:middle;" /> <b>]</b>
                          process.)
                       
                            
                        <br /><br />
                        
                        Each step in the sequence will run inside it's own execution context once the process in the preceding step has completed.

                    
                        <br /><br />
                        
                                   
                        The 
                        <b>[</b> <img src="./ScrapeWebPageTutorial/Wiretap.png" style="vertical-align:middle;" /> <b>]</b>
                        process towards the end of the Sequence will  send an email to the account associated with the user running the test.
                        <br />The email body will contain the values of all message parameters at the point of email transmission from the 
                        <b>[</b> <img src="./ScrapeWebPageTutorial/Wiretap.png" style="vertical-align:middle;" /> <b>]</b>
                        process. 
                        <br />The formatted body should approximate the following.
                        <br /><br />
                      
                            
                        <div style="background: #ffffff; overflow:auto;width:60%;border:solid gray;border-width:.1em .1em .1em .1em;padding:.1em .1em;"><pre style="margin: 0; line-height: 125%">
                        
        {
            <span style="color: #007700">"eda_Position"</span>: <span style="color: #0000DD; font-weight: bold">4</span>,
            <span style="color: #007700">"eda_SequenceName"</span>: <span style="background-color: #fff0f0">"WebScrape"</span>,
            <span style="color: #007700">"Id"</span>: <span style="background-color: #fff0f0">"00Pb0000003dhGUEAY"</span>,
            <span style="color: #007700">"eda_EntryPointGuid"</span>: <span style="background-color: #fff0f0">"db1a234a8d9f5f9304"</span>,
            <span style="color: #007700">"eda_StackDepth"</span>: <span style="color: #0000DD; font-weight: bold">3</span>,
            <span style="color: #007700">"eda_ConfigObjectId"</span>: <span style="color: #008800; font-weight: bold">null</span>,
            <span style="color: #007700">"priceData"</span>: <span style="background-color: #fff0f0">"{\"Stock__c\":  [ {\"ticker__c\": \"CRM\", \"price__c\": 55.97} ] }"</span>
        }
                        </pre></div>  
                        <br />Visually confirm the Sequence worked as expected by inspecting the <code>priceData</code> parameter injected into the message by the <b>[</b> <img src="./ScrapeWebPageTutorial/StockParse.png" style="vertical-align:middle;" /> <b>]</b> process.                    
                    </li>
                    <br />
                    
                </ol></td></tr></table></div></div><div id="j_id0:j_id2:j_id18"><div class="pbSubheader brandTertiaryBgr tertiaryPalette"><h3>Additional Exercises :</h3></div><div class="pbSubsection"><table class="detailList" border="0" cellpadding="0" cellspacing="0"><tr><td class="data2Col  first  last " colSpan="2">
                    <br />
                    The <b>[</b> <img src="./ScrapeWebPageTutorial/Publish.png" style="vertical-align:middle;" /> <b>]</b>
                        process in the  <code>WebScrape</code> sequence publishes to the <code>YAHOO</code> Named Event. 
                    <br /> Any new or existing sequence can now subscribe to that Named Event .
                    <br /><br />
                    <br /> <b> Exercise 1 : </b> consider subscribing to the <code>YAHOO</code> Named Event : 
                    <ul>
                        <li>Create an additional Sequence (name it <code>YahooData</code>) with an initiating <b>[</b> <img src="./ScrapeWebPageTutorial/Subscribe.png" style="vertical-align:middle;" /> <b>]</b> process.
                         </li>
                        <li>Configure the <b>[</b> <img src="./ScrapeWebPageTutorial/Subscribe.png" style="vertical-align:middle;" /> <b>]</b> process so the it subscribes to the <code>YAHOO</code> Named Event.
                        </li>
                        <li>Add a <b>[</b> <img src="./ScrapeWebPageTutorial/Wiretap.png" style="vertical-align:middle;" /> <b>]</b> process to the Sequence.
                        </li>
                        <li>Arrange the  Sequence in the following order :
                        <b>[</b> <img src="./ScrapeWebPageTutorial/Subscribe.png" style="vertical-align:middle;" /> <b>]</b> - 
                        <b>[</b> <img src="./ScrapeWebPageTutorial/Wiretap.png" style="vertical-align:middle;" /> <b>]</b> - 
                        <b>[</b> <img src="./ScrapeWebPageTutorial/Terminate.png" style="vertical-align:middle;" /> <b>]</b>
                        <br /><br />
                        <img src="./ScrapeWebPageTutorial/YahooDataSequence.png" style="vertical-align:middle;" />                         
                        <br />
                        </li>
                        <li><b> <i>Testing</i> : </b> Injecting a new test message into the original <code>WebScrape</code> sequence will trigger  an  email from the <b>[</b> <img src="./ScrapeWebPageTutorial/Wiretap.png" style="vertical-align:middle;" /> <b>]</b> process on the subscribing <code>YahooData</code> sequence.
                        </li>
                    </ul>
                   
                    
                    <br /><br />
                    
                   
                    <br />  <b> Exercise 2 : </b>  consider persisting the price data in a Stock__c SObject : 
                    <ul>
                        <li>On the <code>Stock__c</code>  SObject , create two fields : <code>Ticker__c</code> (Text) and <code>Price__c</code>   (Numeric 10,2) 
                        </li>
                        <li>Construct a new event driven process to persist the stock price  in the <code>Stock__c</code>  SObject. 
                             <br /><br />  <b><i>Hint :</i> </b> Use the following code snippet to assist in building your 
                             <b>[</b> <img src="./ScrapeWebPageTutorial/Persist.png" style="vertical-align:middle;" /> <b>]</b>
                             process.
                             <br /><br />
                        
<div style="background: #ffffff; overflow:auto;width:60%;border:solid gray;border-width:.1em .1em .1em .1em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%">     Map<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span>Object<span style="color: #333333">&gt;</span> parameters <span style="color: #333333">=</span> request<span style="color: #333333">.</span><span style="color: #0000CC">inputParameters</span><span style="color: #333333">;</span>                                                       
    
     String data <span style="color: #333333">=</span> <span style="color: #333333">(</span>String<span style="color: #333333">)</span> parameters<span style="color: #333333">.</span><span style="color: #0000CC">get</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'priceData'</span><span style="color: #333333">);</span>
     String collectionType <span style="color: #333333">=</span> <span style="background-color: #fff0f0">'List&lt;'</span><span style="color: #333333">+</span>   data<span style="color: #333333">.</span><span style="color: #0000CC">substringBefore</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'":'</span><span style="color: #333333">).</span><span style="color: #0000CC">substringAfter</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'"'</span><span style="color: #333333">)</span> <span style="color: #333333">+</span><span style="background-color: #fff0f0">'&gt;'</span><span style="color: #333333">;</span>
     String collectionList <span style="color: #333333">=</span> <span style="background-color: #fff0f0">'['</span> <span style="color: #333333">+</span> data<span style="color: #333333">.</span><span style="color: #0000CC">substringAfter</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">'['</span><span style="color: #333333">).</span><span style="color: #0000CC">substringBefore</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">']'</span><span style="color: #333333">)</span> <span style="color: #333333">+</span><span style="background-color: #fff0f0">']'</span><span style="color: #333333">;</span>
     Type t <span style="color: #333333">=</span>  Type<span style="color: #333333">.</span><span style="color: #0000CC">forname</span><span style="color: #333333">(</span>collectionType<span style="color: #333333">);</span>
     List<span style="color: #333333">&lt;</span>SObject<span style="color: #333333">&gt;</span> sobjects <span style="color: #333333">=</span> <span style="color: #333333">(</span>List<span style="color: #333333">&lt;</span>SObject<span style="color: #333333">&gt;</span> <span style="color: #333333">)</span> json<span style="color: #333333">.</span><span style="color: #0000CC">deserializeStrict</span><span style="color: #333333">(</span>collectionList<span style="color: #333333">,</span> t<span style="color: #333333">);</span>
     insert sobjects<span style="color: #333333">;</span>
                                                                  
     <span style="color: #008800; font-weight: bold">return</span> EdaUtility<span style="color: #333333">.</span><span style="color: #0000CC">convert</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> List<span style="color: #333333">&lt;</span>Map<span style="color: #333333">&lt;</span>String<span style="color: #333333">,</span>Object<span style="color: #333333">&gt;&gt;{</span>parameters<span style="color: #333333">});</span> 

</pre></div>
                        <br />
                         
                        </li>
                        <li>On the  
                            <img src="./ScrapeWebPageTutorial/Processes.png" style="vertical-align:middle;" />  
                            tab, click the 
                            <img src="./ScrapeWebPageTutorial/Discover.png" style="vertical-align:middle;" />  
                            button to make the 
                            <b>[</b> <img src="./ScrapeWebPageTutorial/Persist.png" style="vertical-align:middle;" /> <b>]</b>
                            process available for configuration
                        </li>
                        <li>Modify the <code>YahooData</code> sequence by adding the newly available <b>[</b> <img src="./ScrapeWebPageTutorial/Persist.png" style="vertical-align:middle;" /> <b>]</b> process as a sequence step.
                        </li>
                        <li>Arrange the <code>YahooData</code> sequence  in the following order :  
                          <b>[</b> <img src="./ScrapeWebPageTutorial/Subscribe.png" style="vertical-align:middle;" /> <b>]</b> - 
                          <b>[</b> <img src="./ScrapeWebPageTutorial/Persist.png" style="vertical-align:middle;" /> <b>]</b> - 
                          <b>[</b> <img src="./ScrapeWebPageTutorial/Wiretap.png" style="vertical-align:middle;" /> <b>]</b> - 
                          <b>[</b> <img src="./ScrapeWebPageTutorial/Terminate.png" style="vertical-align:middle;" /> <b>]</b>.
                          <br /><br />
                          <img src="./ScrapeWebPageTutorial/YahooDataPersistSequence.png" style="vertical-align:middle;" /> 
                          <br /> <br />
                        </li>
                        <li><b> <i>Testing</i> : </b> Injecting a new test message into the original <code>WebScrape</code> sequence will insert a dynamic stock price into the <code>Stock__c</code> SObject.
                        </li>
                    </ul></td></tr></table></div></div></div><div class="pbFooter secondaryPalette"><div class="bg"></div></div></div></div></body></html>